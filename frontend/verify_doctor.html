<div class="container mx-auto px-4 py-3 mt-[70px] w-full">
  <!-- Header -->
  <header class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">Doctor Verification</h1>
        <p class="text-gray-600 mt-2">Complete your professional profile for verification</p>
      </div>
      <div class="bg-blue-100 p-3 rounded-full">
        <i class="fas fa-user-md text-blue-600 text-2xl"></i>
      </div>
    </div>
  </header>
    <div class="mb-6 p-4 bg-red-100 text-red-700 rounded-lg">
      You have already submitted a doctor verification request. Please wait for approval.
    </div>

  <!-- Main Form -->
  <form
    id="doctorVerificationForm"
    enctype="multipart/form-data"
    action="assets/php/actions.php?verifydoctor"
    class="bg-white rounded-lg shadow-md p-6 mb-8 w-full ?alreadySubmitted?"
    method="post">
    <h2 class="text-xl font-semibold text-gray-800 mb-6 pb-2 border-b">
      Professional Information
    </h2>

    <!-- Medical Specialty and Years of Experience -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div>
        <label for="specialty" class="block text-gray-700 font-medium mb-2">Medical Specialty</label>
        <select id="specialty" name="specialty" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="">Select your specialty</option>
          <?php
          $specialties = ['cardiology', 'dermatology', 'endocrinology', 'gastroenterology', 'neurology', 'oncology', 'pediatrics', 'psychiatry', 'radiology', 'surgery', 'other'];
          foreach ($specialties as $s):
            $selected = (isset($old['specialty']) && $old['specialty'] == $s) ? 'selected' : '';
          ?>
            <option value="<?= $s ?>" <?= $selected ?>><?= ucfirst($s) ?></option>
        </select>
        <?php if (isset($error['field']) && $error['field'] == 'specialty'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>

      <div>
        <label for="experience" class="block text-gray-700 font-medium mb-2">Years of Experience</label>
        <input type="text" id="experience" name="experience" value="<?= htmlspecialchars($old['experience'] ?? '') ?>" min="0" max="50"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Enter years of experience" />
        <?php if (isset($error['field']) && $error['field'] == 'experience'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>
    </div>

    <!-- Medical License Number -->
    <div class="mb-6">
      <label for="license" class="block text-gray-700 font-medium mb-2">Medical License Number</label>
      <input type="text" id="license" name="license" value="<?= htmlspecialchars($old['license'] ?? '') ?>"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
        placeholder="Enter your medical license number" />
      <?php if (isset($error['field']) && $error['field'] == 'license'): ?>
        <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
      <?php endif; ?>
    </div>

    <!-- Contact Information -->
    <h3 class="text-lg font-semibold text-gray-800 mb-4 mt-8">Contact Information</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div>
        <label for="phone" class="block text-gray-700 font-medium mb-2">Phone Number</label>
        <input type="text" id="phone" name="phone" value="<?= htmlspecialchars($old['phone'] ?? '') ?>"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Enter your phone number" />
        <?php if (isset($error['field']) && $error['field'] == 'phone'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>

      <div>
        <label for="address" class="block text-gray-700 font-medium mb-2">Address</label>
        <textarea id="address" name="address" rows="2"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Enter your address"><?= htmlspecialchars($old['address'] ?? '') ?></textarea>
        <?php if (isset($error['field']) && $error['field'] == 'address'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>
    </div>

    <!-- City and Country -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div>
        <label for="city" class="block text-gray-700 font-medium mb-2">City</label>
        <input type="text" id="city" name="city" value="<?= htmlspecialchars($old['city'] ?? '') ?>"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Enter your city" />
        <?php if (isset($error['field']) && $error['field'] == 'city'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>
      <div>
        <label for="country" class="block text-gray-700 font-medium mb-2">Country</label>
        <input type="text" id="country" name="country" value="<?= htmlspecialchars($old['country'] ?? '') ?>"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Enter your country" />
        <?php if (isset($error['field']) && $error['field'] == 'country'): ?>
          <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
        <?php endif; ?>
      </div>
    </div>

    <!-- Document Upload Section -->
    <h3 class="text-lg font-semibold text-gray-800 mb-4 mt-8">Document Verification</h3>
    <p class="text-gray-600 mb-6">Please upload the following documents. All documents must be clear and legible.</p>

    <?php
    $documents = [
      'citizenshipFront' => 'Citizenship Document (Front)',
      'citizenshipBack' => 'Citizenship Document (Back)',
      'medicalCertificate' => 'Medical Certificate'
    ];
    foreach ($documents as $id => $label):
    ?>
      <div class="mb-6">
        <label class="block text-gray-700 font-medium mb-2"><?= $label ?></label>
        <div class="flex items-center justify-center w-full">
          <label for="<?= $id ?>" class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100">
            <div id="<?= $id ?>Preview" class="preview-container flex flex-col items-center justify-center pt-5 pb-6 w-full h-full <?= isset($old[$id]) ? '' : 'hidden' ?>">
              <img id="<?= $id ?>Img" class="max-h-52 max-w-full" src="<?= $old[$id] ?? '' ?>" alt="<?= $label ?> Preview" />
              <p class="text-sm text-gray-500 mt-2">Click to change</p>
            </div>
            <div id="<?= $id ?>Placeholder" class="flex flex-col items-center justify-center pt-5 pb-6 <?= isset($old[$id]) ? 'hidden' : '' ?>">
              <i class="fas fa-cloud-upload-alt text-gray-400 text-4xl mb-2"></i>
              <p class="mb-2 text-sm text-gray-500"><span class="font-semibold">Click to upload</span> or drag and drop</p>
              <p class="text-xs text-gray-500">PNG, JPG or PDF (MAX. 5MB)</p>
            </div>
            <input type="file" id="<?= $id ?>" name="<?= $id ?>" class="hidden" accept="image/*,.pdf" />
          </label>
          <?php if (isset($error['field']) && $error['field'] == $id): ?>
            <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
          <?php endif; ?>
        </div>
      </div>
    <?php endforeach; ?>

    <!-- Terms -->
    <div class="mb-6">
      <div class="flex items-start">
        <div class="flex items-center h-5">
          <input id="terms" name="terms" type="checkbox" class="w-4 h-4 border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-blue-300" required />
        </div>
        <label for="terms" class="ml-2 text-sm font-medium text-gray-700">
          I agree to the <a href="#" class="text-blue-600 hover:underline">Terms</a> and <a href="#" class="text-blue-600 hover:underline">Privacy Policy</a>.
        </label>
      </div>
      <?php if (isset($error['field']) && $error['field'] == 'terms'): ?>
        <p class="text-red-500 text-sm mt-1"><?= $error['msg'] ?></p>
      <?php endif; ?>
    </div>

    <!-- Submit -->
    <div class="flex justify-end">
      <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
        Submit Verification
      </button>
    </div>
  </form>
</div>

<script>
  // Image preview functionality
  const files = ["citizenshipFront", "citizenshipBack", "medicalCertificate"];
  files.forEach(file => {
    document.getElementById(file).addEventListener("change", function(e) {
      const preview = document.getElementById(file + "Preview");
      const placeholder = document.getElementById(file + "Placeholder");
      const img = document.getElementById(file + "Img");
      if (e.target.files && e.target.files[0]) {
        const reader = new FileReader();
        reader.onload = function(ev) {
          img.src = ev.target.result;
          preview.classList.remove("hidden");
          placeholder.classList.add("hidden");
        }
        reader.readAsDataURL(e.target.files[0]);
      }
    });
  });

  // Basic form validation for old functionality (optional)
  document.getElementById("doctorVerificationForm").addEventListener("submit", function(e) {
    let valid = true;
    const requiredFields = ["specialty", "experience", "license", "phone", "address", "city", "country"];
    requiredFields.forEach(f => {
      const el = document.getElementById(f);
      if (!el.value.trim()) {
        el.classList.add("border-red-500");
        valid = false;
      } else {
        el.classList.remove("border-red-500");
      }
    });
    if (!valid) e.preventDefault();
  });
</script>